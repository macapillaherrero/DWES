<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guía Interactiva: Docker + PHP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Nordic Calm -->
    <!-- Application Structure Plan: The application is structured as a single-page, scrolling guide divided into thematic sections: 'Objetivo', 'Arquitectura', 'Configuración', and 'Ejecución'. This linear flow logically follows the learning process from concept to implementation. The core interactive element is a simulated file explorer in the 'Configuración' section. This design was chosen because it allows users to actively engage with the configuration files one by one, reducing cognitive load and improving comprehension compared to a static display of all files at once. The user flow is guided by a sticky navigation bar, making it easy to jump between sections or follow the process step-by-step. -->
    <!-- Visualization & Content Choices: 
        1. Report Info: Relationship between Nginx, PHP-FPM, and the user's machine. -> Goal: Organize/Inform. -> Viz/Presentation: HTML/CSS Diagram. -> Interaction: Static visual aid. -> Justification: A visual diagram is more intuitive and faster to understand for architectural concepts than pure text. It clearly shows how the containers are connected. -> Library/Method: HTML divs styled with Tailwind CSS.
        2. Report Info: Content of `docker-compose.yml`, `Dockerfile`, `nginx.conf`, `index.php`. -> Goal: Inform/Organize. -> Viz/Presentation: Interactive File Explorer with Code Viewer. -> Interaction: User clicks on a filename to display its content and a detailed explanation. -> Justification: This component makes learning active instead of passive. It breaks down the complex configuration into manageable pieces, allowing users to focus on one file at a time, which is a superior learning experience. -> Library/Method: Vanilla JavaScript for click handling and content switching.
        3. Report Info: Docker commands. -> Goal: Inform. -> Viz/Presentation: Code blocks with copy buttons. -> Interaction: User clicks a button to copy the command. -> Justification: Improves usability by making it easy for the student to use the commands in their own terminal without typos. -> Library/Method: Vanilla JavaScript. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F9FAFB; /* gray-50 */
            color: #1F2937; /* gray-800 */
        }
       .code-block {
            background-color: #1F2937;
            color: #F3F4F6;
            border-radius: 0.5rem;
            padding: 1.5rem;
            font-family: Consolas, "Courier New", monospace;
            font-size: 0.875rem;
            overflow-x: auto;
            white-space: pre-wrap;
            word-break: break-all;
        }
        .explanation-card {
            background-color: #F3F4F6; /* gray-200 */
            border-left: 4px solid #3B82F6; /* blue-500 */
        }
        .active-file {
            background-color: #DBEAFE; /* blue-100 */
            color: #1E40AF; /* blue-800 */
            font-weight: 600;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 border-b border-gray-200">
        <nav class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <span class="text-xl font-bold text-blue-600">Docker + PHP</span>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#objetivo" class="text-gray-600 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium">Objetivo</a>
                        <a href="#arquitectura" class="text-gray-600 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium">Arquitectura</a>
                        <a href="#configuracion" class="text-gray-600 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium">Configuración</a>
                        <a href="#ejecucion" class="text-gray-600 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium">Ejecución</a>
                        <a href="/index.html" class="text-gray-600 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium">Inicio</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12">

        <section id="objetivo" class="mb-24 text-center">
            <h1 class="text-4xl md:text-5xl font-bold tracking-tight text-gray-900 mb-4">Entorno de Desarrollo PHP con Docker</h1>
            <p class="max-w-3xl mx-auto text-lg text-gray-600">
                Esta guía interactiva te mostrará cómo crear un entorno de desarrollo local completo para PHP utilizando Docker. Aprenderás a configurar y conectar un servidor web Nginx con un procesador PHP-FPM, creando un sistema robusto y aislado para tus proyectos.
            </p>
        </section>

        <section id="arquitectura" class="mb-24">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900">Arquitectura de Servicios</h2>
                <p class="mt-2 text-md text-gray-600">Así es como interactúan los componentes de nuestro entorno Docker.</p>
            </div>
            <div class="flex flex-col md:flex-row items-center justify-center gap-8 text-center">
                <div class="w-full md:w-1/4 p-6 bg-white rounded-xl shadow-md border border-gray-200">
                    <div class="text-5xl mb-3">💻</div>
                    <h3 class="font-bold text-lg">Tu Ordenador</h3>
                    <p class="text-sm text-gray-600">Accedes al proyecto a través de `localhost:8080`.</p>
                </div>
                
                <div class="text-gray-400 font-mono text-2xl transform rotate-90 md:rotate-0">&lt;--&gt;</div>
                
                <div class="w-full md:w-1/3 p-6 bg-white rounded-xl shadow-lg border-2 border-blue-500 relative">
                    <span class="absolute -top-3 -left-3 flex h-6 w-6">
                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"></span>
                        <span class="relative inline-flex rounded-full h-6 w-6 bg-blue-500 text-white items-center justify-center text-xs font-bold">1</span>
                    </span>
                    <div class="text-5xl mb-3">📦</div>
                    <h3 class="font-bold text-lg text-blue-700">Contenedor Nginx</h3>
                    <p class="text-sm text-gray-600">Recibe la petición y si es un archivo `.php`, la envía al contenedor de PHP.</p>
                </div>

                <div class="text-gray-400 font-mono text-2xl transform rotate-90 md:rotate-0">&lt;--&gt;</div>
                
                <div class="w-full md:w-1/3 p-6 bg-white rounded-xl shadow-lg border-2 border-green-500 relative">
                     <span class="absolute -top-3 -left-3 flex h-6 w-6">
                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                        <span class="relative inline-flex rounded-full h-6 w-6 bg-green-500 text-white items-center justify-center text-xs font-bold">2</span>
                    </span>
                    <div class="text-5xl mb-3">🐘</div>
                    <h3 class="font-bold text-lg text-green-700">Contenedor PHP-FPM</h3>
                    <p class="text-sm text-gray-600">Procesa el código PHP y devuelve el resultado a Nginx.</p>
                </div>
            </div>
        </section>

        <section id="configuracion" class="mb-24">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900">Configuración de Archivos</h2>
                <p class="mt-2 text-md text-gray-600">Explora cada archivo para entender su función. Haz clic en un nombre para ver su contenido y explicación.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-12 gap-8">
                <div class="md:col-span-3">
                    <div class="bg-white rounded-xl shadow-md border border-gray-200 p-4">
                        <h3 class="font-bold mb-3 text-gray-700">📂 mi-proyecto/</h3>
                        <ul id="file-list" class="space-y-1">
                            <li><a href="#" data-file="compose" class="block p-2 rounded-md text-gray-700 hover:bg-gray-100 active-file">docker-compose.yml</a></li>
                            <li><a href="#" data-file="dockerfile" class="block p-2 rounded-md text-gray-700 hover:bg-gray-100">Dockerfile</a></li>
                            <li><a href="#" data-file="nginx" class="block p-2 rounded-md text-gray-700 hover:bg-gray-100">nginx.conf</a></li>
                            <li><a href="#" data-file="php" class="block p-2 rounded-md text-gray-700 hover:bg-gray-100">app/index.php</a></li>
                        </ul>
                    </div>
                </div>
                <div class="md:col-span-9 grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div id="code-display" class="w-full">
                

                        <!-- Content will be injected by JS -->
                    </div>
                    <div id="explanation-display" class="w-full">
                        <!-- Content will be injected by JS -->
                    </div>
                </div>
            </div>
        </section>

        <section id="ejecucion" class="mb-16">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900">Ejecución y Verificación</h2>
                <p class="mt-2 text-md text-gray-600">Usa estos comandos en tu terminal, dentro de la carpeta `mi-proyecto/`.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-start">
                <div>
                    <h3 class="font-semibold text-xl mb-4 text-gray-800">1. Iniciar los contenedores</h3>
                    <div class="relative">
                        <div class="code-block" id="start-command">docker compose up -d</div>
                        <button onclick="copyCommand('start-command')" class="absolute top-2 right-2 bg-gray-600 hover:bg-gray-500 text-white py-1 px-2 rounded-md text-xs">Copiar</button>
                    </div>
                    <ul class="mt-4 list-disc list-inside text-gray-600 space-y-1">
                        <li><b>`up`</b>: Construye, (re)crea, inicia y adjunta los contenedores para un servicio.</li>
                        <li><b>`-d`</b>: Modo "detached", ejecuta los contenedores en segundo plano.</li>
                    </ul>

                    <h3 class="font-semibold text-xl mb-4 mt-8 text-gray-800">3. Detener los contenedores</h3>
                     <div class="relative">
                        <div class="code-block" id="stop-command">docker compose down</div>
                         <button onclick="copyCommand('stop-command')" class="absolute top-2 right-2 bg-gray-600 hover:bg-gray-500 text-white py-1 px-2 rounded-md text-xs">Copiar</button>
                    </div>
                     <p class="mt-4 text-gray-600">
                        Este comando detiene y elimina los contenedores, redes y volúmenes creados por `up`.
                    </p>
                </div>
                 <div>
                    <h3 class="font-semibold text-xl mb-4 text-gray-800">2. Verificar el resultado</h3>
                     <div class="w-full bg-white rounded-xl shadow-2xl border border-gray-200 overflow-hidden">
                        <div class="h-8 bg-gray-100 flex items-center px-4 space-x-2">
                            <div class="w-3 h-3 bg-red-500 rounded-full"></div>
                            <div class="w-3 h-3 bg-yellow-400 rounded-full"></div>
                            <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                        </div>
                        <div class="p-2 bg-white flex items-center border-b border-gray-200">
                             <div class="bg-gray-100 rounded-full py-1 px-4 text-sm text-gray-700 w-full">
                                http://localhost:8080
                            </div>
                        </div>
                        <div class="p-6 bg-gray-50 text-gray-800">
                            <p>¡Hola desde Docker! 🐳</p>
                            <p>La versión de PHP es: 8.3.x</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <script>
        const fileContents = {
            compose: {
                code: `version: '3.8'

services:
  nginx:
    image: nginx:stable-alpine
    container_name: web-server
    ports:
      - "8080:80"
    volumes:
      - ./app:/var/www/html
      - ./nginx.conf:/etc/nginx/conf.d/default.conf
    depends_on:
      - php

  php:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: php-fpm
    volumes:
      - ./app:/var/www/html`,
                explanation: `
                    <div class="explanation-card p-4 rounded-lg h-full">
                        <h4 class="font-bold text-lg mb-2 text-gray-900">docker-compose.yml</h4>
                        <p class="text-sm text-gray-700 mb-4">Este archivo es el director de orquesta. Define los servicios (contenedores) que componen tu aplicación y cómo se conectan entre sí.</p>
                        <ul class="text-sm space-y-3 text-gray-800">
                            <li><b class="text-blue-700">services.nginx</b>: Define el contenedor del servidor web. Usa una imagen oficial de Nginx, mapea el puerto 8080 de tu PC al 80 del contenedor y sincroniza el código y la configuración.</li>
                            <li><b class="text-blue-700">services.php</b>: Define el contenedor de PHP. En lugar de usar una imagen pre-hecha, le decimos que la construya (<code>build</code>) usando nuestro <code>Dockerfile</code>.</li>
                            <li><b class="text-blue-700">volumes</b>: Sincroniza carpetas entre tu máquina y el contenedor. Los cambios en tu código se reflejan al instante.</li>
                            <li><b class="text-blue-700">depends_on</b>: Asegura que el contenedor de PHP se inicie antes que el de Nginx.</li>
                        </ul>
                    </div>
                `
            },
            dockerfile: {
                code: `# Usa una imagen de PHP con FPM
FROM php:8.3-fpm-alpine

# Instala extensiones de PHP necesarias
RUN docker-php-ext-install pdo_mysql opcache`,
                explanation: `
                    <div class="explanation-card p-4 rounded-lg h-full">
                        <h4 class="font-bold text-lg mb-2 text-gray-900">Dockerfile</h4>
                        <p class="text-sm text-gray-700 mb-4">Este archivo es la receta para construir nuestra imagen de PHP personalizada.</p>
                        <ul class="text-sm space-y-3 text-gray-800">
                            <li><b class="text-blue-700">FROM</b>: Especifica la imagen base sobre la que construiremos. <code>php:8.3-fpm-alpine</code> es una excelente opción: es oficial, usa PHP 8.3, incluye FPM (para comunicarse con Nginx) y es muy ligera (Alpine Linux).</li>
                            <li><b class="text-blue-700">RUN</b>: Ejecuta comandos durante el proceso de construcción de la imagen. Aquí usamos un script de ayuda (<code>docker-php-ext-install</code>) para instalar extensiones de PHP comunes como la de MySQL y Opcache.</li>
                        </ul>
                    </div>
                `
            },
            nginx: {
                code: `server {
    listen 80;
    index index.php index.html;
    root /var/www/html;

    location ~ \\.php$ {
        try_files $uri =404;
        fastcgi_split_path_info ^(.+\\.php)(/.+)$;
        fastcgi_pass php:9000;
        fastcgi_index index.php;
        include fastcgi_params;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
    }
}`,
                explanation: `
                    <div class="explanation-card p-4 rounded-lg h-full">
                        <h4 class="font-bold text-lg mb-2 text-gray-900">nginx.conf</h4>
                        <p class="text-sm text-gray-700 mb-4">Define cómo Nginx debe manejar las peticiones entrantes.</p>
                        <ul class="text-sm space-y-3 text-gray-800">
                            <li><b class="text-blue-700">root</b>: Establece el directorio raíz donde Nginx buscará los archivos. Coincide con el volumen que montamos.</li>
                            <li><b class="text-blue-700">location ~ \\.php$</b>: Es la regla más importante. Le dice a Nginx qué hacer cuando una petición es para un archivo que termina en <code>.php</code>.</li>
                            <li><b class="text-blue-700">fastcgi_pass php:9000</b>: Pasa la petición al servicio llamado 'php' (el nombre de nuestro servicio en <code>docker-compose.yml</code>) en el puerto 9000, que es el puerto por defecto de PHP-FPM.</li>
                        </ul>
                    </div>
                `
            },
            php: {
                code: `<?php

echo "¡Hola desde Docker! 🐳<br>";
echo "La versión de PHP es: " . phpversion();
?>`,
                explanation: `
                    <div class="explanation-card p-4 rounded-lg h-full">
                        <h4 class="font-bold text-lg mb-2 text-gray-900">app/index.php</h4>
                        <p class="text-sm text-gray-700 mb-4">Un simple script de PHP para verificar que todo el sistema funciona correctamente.</p>
                        <ul class="text-sm space-y-3 text-gray-800">
                            <li>Este archivo se encuentra en la carpeta <code>app</code> de tu proyecto.</li>
                            <li>Gracias a la magia de los volúmenes de Docker, este archivo es accesible tanto para el contenedor de Nginx como para el de PHP en la ruta <code>/var/www/html</code>.</li>
                            <li>Al visitar <code>localhost:8080</code>, Nginx sirve este archivo, se lo pasa a PHP-FPM para que lo procese, y te devuelve el resultado.</li>
                        </ul>
                    </div>
                `
            }
        };

        const fileList = document.getElementById('file-list');
        const codeDisplay = document.getElementById('code-display');
        const explanationDisplay = document.getElementById('explanation-display');

        function updateDisplay(fileName) {
            const content = fileContents[fileName];
            codeDisplay.innerHTML = `<div class="code-block h-full">${content.code.replace(/</g, "&lt;").replace(/>/g, "&gt;")}</div>`;
            explanationDisplay.innerHTML = content.explanation;
        }

        fileList.addEventListener('click', (e) => {
            e.preventDefault();
            if (e.target.tagName === 'A') {
                const file = e.target.dataset.file;
                
                document.querySelectorAll('#file-list a').forEach(link => link.classList.remove('active-file'));
                e.target.classList.add('active-file');
                
                updateDisplay(file);
            }
        });

        function copyCommand(elementId) {
            const commandText = document.getElementById(elementId).innerText;
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = commandText;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextArea);

            const button = document.querySelector(`button[onclick="copyCommand('${elementId}')"]`);
            const originalText = button.innerText;
            button.innerText = '¡Copiado!';
            setTimeout(() => {
                button.innerText = originalText;
            }, 2000);
        }

        updateDisplay('compose');

    </script>
</body>
</html>
